var txt1 = `21.12.29
앵지 김경모 물방개 이유란
허유 연어덮밥 나무늘봉순 카히리
1
연어덮밥 이유란 물방개 김경모 나무늘봉순 앵지 허유 카히리 노르테유부스터존점령작전 0
물방개 연어덮밥 허유 김경모 앵지 나무늘봉순 이유란 카히리 네모메디아은신처 5
연어덮밥 카히리 앵지 허유 물방개 김경모 이유란 나무늘봉순 동화프레티온목마 0
연어덮밥 앵지 이유란 허유 나무늘봉순 김경모 물방개 카히리 아이스짜릿한동계훈련장 0
이유란 연어덮밥 물방개 앵지 김경모 카히리 나무늘봉순 허유 아이스신나는하프파이프 0
김경모 나무늘봉순 앵지 허유 카히리 이유란 연어덮밥 물방개 사막스핑크스수수께끼 3
허유 물방개 김경모 나무늘봉순 연어덮밥 카히리 앵지 이유란 노르테유부스터존점령작전 8
김경모 허유 나무늘봉순 카히리 연어덮밥 물방개 이유란 앵지 차이나북경자금성 0
김경모 나무늘봉순 물방개 앵지 허유 이유란 연어덮밥 카히리 아이스신나는하프파이프 0
앵지 허유 물방개 나무늘봉순 연어덮밥 이유란 카히리 김경모 아이스짜릿한동계훈련장 0
이유란 물방개 허유 김경모 카히리 앵지 나무늘봉순 연어덮밥 차이나상해동방명주 0
김경모 연어덮밥 물방개 나무늘봉순 카히리 허유 앵지 이유란 황금문명전설의황금용광로 0
김경모 이유란 허유 연어덮밥 나무늘봉순 물방개 앵지 카히리 해적짜릿한고공비행 0
나무늘봉순 연어덮밥 김경모 앵지 이유란 허유 카히리 물방개 신화빛의길 0
김경모 허유 물방개 나무늘봉순 연어덮밥 카히리 앵지 이유란 노르테유붕붕점프 0
연어덮밥 나무늘봉순 물방개 허유 김경모 이유란 앵지 카히리 아이스펭귄전사눈덩이공격 8
김경모 앵지 허유 물방개 이유란 나무늘봉순 카히리 연어덮밥 어비스바다의인도자 6
김경모 카히리 이유란 연어덮밥 허유 물방개 앵지 나무늘봉순 마비노기티르코네일 5,21.12.26
앵지 김윤환 러아 오세블리
김성대 나무늘봉순 혜로로 이유란
2
김윤환 김성대 나무늘봉순 러아 오세블리 앵지 이유란 혜로로 코리아한국민속촌 8
앵지 김윤환 김성대 이유란 혜로로 러아 나무늘봉순 오세블리 아이스신나는하프파이프 8
김윤환 앵지 나무늘봉순 러아 김성대 혜로로 오세블리 이유란 코리아롯데월드어드벤쳐 8
나무늘봉순 혜로로 러아 김성대 앵지 김윤환 이유란 오세블리 노르테유부스터존점령작전 2
나무늘봉순 김윤환 혜로로 앵지 김성대 이유란 러아 오세블리 어비스바다의인도자 5
김윤환 김성대 이유란 앵지 러아 나무늘봉순 오세블리 혜로로 차이나상해동방명주 0
혜로로 김윤환 앵지 나무늘봉순 김성대 이유란 러아 오세블리 해적짜릿한고공비행 0
김성대 나무늘봉순 이유란 김윤환 앵지 혜로로 러아 오세블리 코리아롯데월드어드벤쳐 7
혜로로 앵지 김윤환 김성대 이유란 오세블리 나무늘봉순 러아 황금문명전설의황금용광로 5
이유란 러아 오세블리 나무늘봉순 김윤환 혜로로 김성대 앵지 코리아한국민속촌 0
나무늘봉순 혜로로 이유란 러아 김성대 앵지 김윤환 오세블리 해적짜릿한고공비행 0
나무늘봉순 오세블리 러아 김윤환 김성대 혜로로 앵지 이유란 아이스펭귄전사눈덩이공격 0
김성대 앵지 나무늘봉순 러아 이유란 김윤환 혜로로 오세블리 황금문명신비의황금콘도르 8
앵지 나무늘봉순 김윤환 오세블리 김성대 러아 이유란 혜로로 동화프레티온목마 0
김윤환 김성대 앵지 러아 이유란 혜로로 오세블리 나무늘봉순 네모메디아은신처 3
이유란 러아 나무늘봉순 오세블리 앵지 김성대 김윤환 혜로로 사막스핑크스수수께끼 0
앵지 김성대 이유란 러아 나무늘봉순 김윤환 오세블리 혜로로 노르테유붕붕점프 7
김윤환 앵지 이유란 러아 김성대 나무늘봉순 혜로로 오세블리 노르테유부스터존점령작전 4
김윤환 이유란 나무늘봉순 오세블리 앵지 러아 김성대 혜로로 차이나상해동방명주 0
김성대 김윤환 나무늘봉순 앵지 이유란 러아 혜로로 오세블리 황금문명CSO아즈텍 8
앵지 러아 이유란 김성대 나무늘봉순 김윤환 혜로로 오세블리 아이스짜릿한동계훈련장 0
앵지 김윤환 김성대 혜로로 이유란 러아 나무늘봉순 오세블리 어비스바다의인도자 8
이유란 나무늘봉순 김윤환 김성대 혜로로 앵지 러아 오세블리 공동묘지어둠의박쥐성 6
김성대 러아 이유란 혜로로 김윤환 나무늘봉순 오세블리 앵지 아이스신나는하프파이프 8
이유란 김성대 김윤환 러아 앵지 혜로로 나무늘봉순 오세블리 마비노기티르코네일 7
김성대 나무늘봉순 이유란 앵지 김윤환 러아 혜로로 오세블리 신화빛의길 5
김성대 김윤환 앵지 이유란 혜로로 오세블리 나무늘봉순 러아 차이나북경자금성 8
김성대 러아 김윤환 나무늘봉순 앵지 오세블리 이유란 혜로로 마비노기티르코네일 3`;

function createRecordList(txt){
	var record_list = [];;
	var temps = txt.split(',');
	for(var t = 0;t<temps.length;t++){	
		var record = {};
		
		var temp = temps[t].split('\n');
		record['date'] = temp[0];
		record['member']=[temp[1].split(' '),temp[2].split(' ')];
		record['winner'] = temp[3];
		record['game'] = [];
		for(var i=4;i<temp.length;i++){
			record['game'].push(temp[i].split(' '));
		}
		
		record_list.push(record);
	}

	//log(JSON.stringify(record_list));
	return record_list;	
}


// 총 전적. 승 패
// 게임별 평균 등수
// 게임별 모든 등수
// 맵 당 편균 등수
// 맵 당 1등한 횟수
// 맵 당 꼴지, 리타이어 한 횟수
// 가장 많이 승리한 멤버
// 가장 많이 패배한 멤버
// 가장 승률 좋은 멤버
// 가장 승률 안 좋은 멤버
// 가장 많이 승리한 상대편
// 가장 많이 패배한 상대편
// 가장 승률 좋은 상대편
// 가장 승률 안 좋은 상대편


//createStatistics('앵지');

function createStatistics(name){
	
	var record_list = createRecordList(txt1);
	
	name = '앵지';
	
	var statistics = {};
	statistics['win'] = 0;
	statistics['loose'] = 0;
	statistics['rank'] = [];
	statistics['map'] = {};

	statistics['winner'] = {};
	statistics['looser'] = {};
	statistics['winner_opponent'] = {};
	statistics['looser_opponent'] = {};


	for(var r=0;r<record_list.length;r++){
		statistics['rank'][r] = [];
		var record = record_list[r];
		if(!record['member'][0].includes(name) && !record['member'][1].includes(name)){
			continue;
		}
		
		if(record['winner']==1){
			if(record['member'][0].includes(name)){
				statistics['win']++;
			}else{
				statistics['loose']++;
			}
			
			for(var i=0;i<record['member'][0].length;i++){
				if(statistics['winner'].hasOwnProperty(record['member'][0][i])){
					statistics['winner'][record['member'][0][i]]++;
				}else{
					statistics['winner'][record['member'][0][i]] = 1;
				}
			}	
			for(var i=0;i<record['member'][1].length;i++){
				if(statistics['looser_opponent'].hasOwnProperty(record['member'][1][i])){
					statistics['looser_opponent'][record['member'][1][i]]++;
				}else{
					statistics['looser_opponent'][record['member'][1][i]] = 1;
				}
			}	
		}else{
			if( ! record['member'][0].includes(name)){
				statistics['win']++;
			}else{
				statistics['loose']++;
			}
			
			for(var i=0;i<record['member'][0].length;i++){
				if(statistics['looser'].hasOwnProperty(record['member'][0][i])){
					statistics['looser'][record['member'][0][i]]++;
				}else{
					statistics['looser'][record['member'][0][i]] = 1;
				}
			}	
			for(var i=0;i<record['member'][1].length;i++){
				if(statistics['winner_opponent'].hasOwnProperty(record['member'][1][i])){
					statistics['winner_opponent'][record['member'][1][i]]++;
				}else{
					statistics['winner_opponent'][record['member'][1][i]] = 1;
				}
			}		
		}
				
		for(var i=0;i<record['game'].length;i++){
			statistics['rank'][r].push((record['game'][i].indexOf(name)) + 1);
			if(!statistics['map'].hasOwnProperty(record['game'][i][8])){
				statistics['map'][record['game'][i][8]] = [];
			}
			
			statistics['map'][record['game'][i][8]].push((record['game'][i].indexOf(name)) + 1);			
		}		
	}
	
	log(JSON.stringify(statistics));
}



//createStatisticsByDate('dddd');



function createStatisticsByDate(date){
	
	var record_list = createRecordList(txt1);
	
	date = '21.12.29';
	
	var statistics = {};
	statistics['member'] = [];
	statistics['map'] = [];
	
	for(var r=0;r<record_list.length;r++){
		var record = record_list[r];
		if(record['date'] == date) {
			var member = [...record['member'][0], ...record['member'][1]];
			for(var i=0;i<member.length;i++){
				statistics[member[i]] = [];
			}
						
			for(var r=0;r<record['game'].length;r++){
				statistics['map'].push(record['game'][i][8]);
				for(var i=0;i<member.length;i++){
					statistics[member[i]].push((record['game'][r].indexOf(member[i])) + 1);
				}
			}
			break;
		}	
	}
	
	log(JSON.stringify(statistics));
}















